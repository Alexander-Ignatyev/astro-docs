<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module: Data.Astro.Time.Sidereal
Description: Sidereal Time
Copyright: Alexander Ignatyev, 2016

According to the Sidereal Clock any observed star returns to the same position
in the sky every 24 hours.

Each sidereal day is shorter than the solar day, 24 hours of sidereal time
corresponding to 23:56:04.0916 of solar time.
-}</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">Sidereal</span><span>
</span><a name="line-14"></a><span class="hs-special">(</span><span>
</span><a name="line-15"></a><span>  </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#dhToGST"><span class="hs-identifier hs-var">dhToGST</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#dhToLST"><span class="hs-identifier hs-var">dhToLST</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToDH"><span class="hs-identifier hs-var">gstToDH</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToDH"><span class="hs-identifier hs-var">lstToDH</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#hmsToGST"><span class="hs-identifier hs-var">hmsToGST</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#hmsToLST"><span class="hs-identifier hs-var">hmsToLST</span></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#utToGST"><span class="hs-identifier hs-var">utToGST</span></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToUT"><span class="hs-identifier hs-var">gstToUT</span></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToLST"><span class="hs-identifier hs-var">gstToLST</span></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToGST"><span class="hs-identifier hs-var">lstToGST</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToGSTwDC"><span class="hs-identifier hs-var">lstToGSTwDC</span></a><span>
</span><a name="line-28"></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Types.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DecimalHours"><span class="hs-identifier hs-type">DecimalHours</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#fromHMS"><span class="hs-identifier hs-var">fromHMS</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Time.JulianDate.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JulianDate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#numberOfCenturies"><span class="hs-identifier hs-var">numberOfCenturies</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#splitToDayAndTime"><span class="hs-identifier hs-var">splitToDayAndTime</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Time.Epoch.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">Epoch</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Epoch.html#j2000"><span class="hs-identifier hs-var">j2000</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Utils.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Astro.Types.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">C</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- | Greenwich Sidereal Time</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- GST can be in range [-12h, 36h] carrying out a day correction</span><span>
</span><a name="line-40"></a><span class="hs-keyword">newtype</span><span> </span><a name="GreenwichSiderealTime"><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier">GreenwichSiderealTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GST"><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier">GST</span></a></a><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Local Sidereal Time</span><span>
</span><a name="line-44"></a><span class="hs-keyword">newtype</span><span> </span><a name="LocalSiderealTime"><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier">LocalSiderealTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LST"><a href="Data.Astro.Time.Sidereal.html#LST"><span class="hs-identifier">LST</span></a></a><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- | Convert Decimal Hours to Greenwich Sidereal Time</span><span>
</span><a name="line-48"></a><span class="hs-identifier">dhToGST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalHours"><span class="hs-identifier hs-type">DecimalHours</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span>
</span><a name="line-49"></a><a name="dhToGST"><a href="Data.Astro.Time.Sidereal.html#dhToGST"><span class="hs-identifier">dhToGST</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">DH</span></a><span> </span><a name="local-6989586621679032373"><a href="#local-6989586621679032373"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a href="#local-6989586621679032373"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- | Convert Decimal Hours to Local Sidereal Time</span><span>
</span><a name="line-53"></a><span class="hs-identifier">dhToLST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalHours"><span class="hs-identifier hs-type">DecimalHours</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span>
</span><a name="line-54"></a><a name="dhToLST"><a href="Data.Astro.Time.Sidereal.html#dhToLST"><span class="hs-identifier">dhToLST</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">DH</span></a><span> </span><a name="local-6989586621679032374"><a href="#local-6989586621679032374"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LST"><span class="hs-identifier hs-var">LST</span></a><span> </span><a href="#local-6989586621679032374"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | Convert Greenwich Sidereal Time to Decimal Hours</span><span>
</span><a name="line-58"></a><span class="hs-identifier">gstToDH</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalHours"><span class="hs-identifier hs-type">DecimalHours</span></a><span>
</span><a name="line-59"></a><a name="gstToDH"><a href="Data.Astro.Time.Sidereal.html#gstToDH"><span class="hs-identifier">gstToDH</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a name="local-6989586621679032375"><a href="#local-6989586621679032375"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">DH</span></a><span> </span><a href="#local-6989586621679032375"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Convert Local Sidereal Time to Decimal Hours</span><span>
</span><a name="line-63"></a><span class="hs-identifier">lstToDH</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalHours"><span class="hs-identifier hs-type">DecimalHours</span></a><span>
</span><a name="line-64"></a><a name="lstToDH"><a href="Data.Astro.Time.Sidereal.html#lstToDH"><span class="hs-identifier">lstToDH</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#LST"><span class="hs-identifier hs-var">LST</span></a><span> </span><a name="local-6989586621679032376"><a href="#local-6989586621679032376"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">DH</span></a><span> </span><a href="#local-6989586621679032376"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Comvert Hours, Minutes, Seconds to Greenwich Sidereal Time</span><span>
</span><a name="line-68"></a><span class="hs-identifier">hmsToGST</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span>
</span><a name="line-69"></a><a name="hmsToGST"><a href="Data.Astro.Time.Sidereal.html#hmsToGST"><span class="hs-identifier">hmsToGST</span></a></a><span> </span><a name="local-6989586621679032377"><a href="#local-6989586621679032377"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679032378"><a href="#local-6989586621679032378"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679032379"><a href="#local-6989586621679032379"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#dhToGST"><span class="hs-identifier hs-var">dhToGST</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#fromHMS"><span class="hs-identifier hs-var">fromHMS</span></a><span> </span><a href="#local-6989586621679032377"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679032378"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679032379"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Comvert Hours, Minutes, Seconds to Local Sidereal Time</span><span>
</span><a name="line-73"></a><span class="hs-identifier">hmsToLST</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span>
</span><a name="line-74"></a><a name="hmsToLST"><a href="Data.Astro.Time.Sidereal.html#hmsToLST"><span class="hs-identifier">hmsToLST</span></a></a><span> </span><a name="local-6989586621679032380"><a href="#local-6989586621679032380"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679032381"><a href="#local-6989586621679032381"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679032382"><a href="#local-6989586621679032382"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#dhToLST"><span class="hs-identifier hs-var">dhToLST</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#fromHMS"><span class="hs-identifier hs-var">fromHMS</span></a><span> </span><a href="#local-6989586621679032380"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679032381"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679032382"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Convert from Universal Time (UT) to Greenwich Sidereal Time (GST)</span><span>
</span><a name="line-78"></a><span class="hs-identifier">utToGST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span>
</span><a name="line-79"></a><a name="utToGST"><a href="Data.Astro.Time.Sidereal.html#utToGST"><span class="hs-identifier">utToGST</span></a></a><span> </span><a name="local-6989586621679032383"><a href="#local-6989586621679032383"><span class="hs-identifier">jd</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><a name="local-6989586621679032384"><a href="#local-6989586621679032384"><span class="hs-identifier">day</span></a></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><a name="local-6989586621679032385"><a href="#local-6989586621679032385"><span class="hs-identifier">time</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.JulianDate.html#splitToDayAndTime"><span class="hs-identifier hs-var">splitToDayAndTime</span></a><span> </span><a href="#local-6989586621679032383"><span class="hs-identifier hs-var">jd</span></a><span>
</span><a name="line-81"></a><span>      </span><a name="local-6989586621679032386"><a href="#local-6989586621679032386"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#solarSiderealTimesDiff"><span class="hs-identifier hs-var">solarSiderealTimesDiff</span></a><span> </span><a href="#local-6989586621679032384"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-82"></a><span>      </span><a name="local-6989586621679032387"><a href="#local-6989586621679032387"><span class="hs-identifier">time'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">24</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032385"><span class="hs-identifier hs-var">time</span></a><span class="hs-operator hs-var">*</span><span class="hs-number">24</span><span class="hs-operator hs-var">/</span><a href="Data.Astro.Time.Sidereal.html#siderealDayLength"><span class="hs-identifier hs-var">siderealDayLength</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679032386"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-83"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-var">time'</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | Convert from Greenwich Sidereal Time (GST) to Universal Time (UT).</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- It takes GST and Greenwich Date, returns JulianDate.</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- Because the sidereal day is shorter than the solar day (see comment to the module).</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- In case of such ambiguity the early time will be returned.</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- You can easily check the ambiguity: if time is equal or less 00:03:56</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- you can get the second time by adding 23:56:04</span><span>
</span><a name="line-92"></a><span class="hs-identifier">gstToUT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span>
</span><a name="line-93"></a><a name="gstToUT"><a href="Data.Astro.Time.Sidereal.html#gstToUT"><span class="hs-identifier">gstToUT</span></a></a><span> </span><a name="local-6989586621679032388"><a href="#local-6989586621679032388"><span class="hs-identifier">jd</span></a></a><span> </span><a name="local-6989586621679032389"><a href="#local-6989586621679032389"><span class="hs-identifier">gst</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032394"><a href="#local-6989586621679032394"><span class="hs-identifier">day</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032395"><a href="#local-6989586621679032395"><span class="hs-identifier">time</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-var">dayTime</span></a><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-var">jd</span></a><span> </span><a href="#local-6989586621679032389"><span class="hs-identifier hs-var">gst</span></a><span>
</span><a name="line-95"></a><span>      </span><a name="local-6989586621679032396"><a href="#local-6989586621679032396"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#solarSiderealTimesDiff"><span class="hs-identifier hs-var">solarSiderealTimesDiff</span></a><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-96"></a><span>      </span><a name="local-6989586621679032397"><a href="#local-6989586621679032397"><span class="hs-identifier">time'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032395"><span class="hs-identifier hs-var">time</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679032396"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Data.Astro.Time.Sidereal.html#siderealDayLength"><span class="hs-identifier hs-var">siderealDayLength</span></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-var">day</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679032397"><span class="hs-identifier hs-var">time'</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">24</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679032390"><a href="#local-6989586621679032390"><span class="hs-identifier">dayTime</span></a></a><span> </span><a name="local-6989586621679032391"><a href="#local-6989586621679032391"><span class="hs-identifier">jd</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a name="local-6989586621679032392"><a href="#local-6989586621679032392"><span class="hs-identifier">gst</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-var">gst</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032393"><span class="hs-identifier hs-var">day</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-var">gst</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">24</span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-var">gst</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032393"><span class="hs-identifier hs-var">day</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-var">gst</span></a><span class="hs-glyph">-</span><span class="hs-number">24</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032393"><span class="hs-identifier hs-var">day</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-var">gst</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><a name="local-6989586621679032393"><a href="#local-6989586621679032393"><span class="hs-identifier">day</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.JulianDate.html#splitToDayAndTime"><span class="hs-identifier hs-var">splitToDayAndTime</span></a><span> </span><a href="#local-6989586621679032391"><span class="hs-identifier hs-var">jd</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- | Convert Greenwich Sidereal Time to Local Sidereal Time.</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- It takes GST and longitude in decimal degrees</span><span>
</span><a name="line-107"></a><span class="hs-identifier">gstToLST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">C</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span>
</span><a name="line-108"></a><a name="gstToLST"><a href="Data.Astro.Time.Sidereal.html#gstToLST"><span class="hs-identifier">gstToLST</span></a></a><span> </span><a name="local-6989586621679032398"><a href="#local-6989586621679032398"><span class="hs-identifier">longitude</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a name="local-6989586621679032399"><a href="#local-6989586621679032399"><span class="hs-identifier">gst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DH</span></a><span> </span><a name="local-6989586621679032400"><a href="#local-6989586621679032400"><span class="hs-identifier">dhours</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toDecimalHours"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toDecimalHours</span></a><span> </span><a href="#local-6989586621679032398"><span class="hs-identifier hs-var">longitude</span></a><span>
</span><a name="line-110"></a><span>      </span><a name="local-6989586621679032401"><a href="#local-6989586621679032401"><span class="hs-identifier">lst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">24</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032399"><span class="hs-identifier hs-var">gst</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679032400"><span class="hs-identifier hs-var">dhours</span></a><span>
</span><a name="line-111"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LST"><span class="hs-identifier hs-var">LST</span></a><span> </span><a href="#local-6989586621679032401"><span class="hs-identifier hs-var">lst</span></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Convert Local Sidereal Time to Greenwich Sidereal Time</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- It takes LST and longitude in decimal degrees</span><span>
</span><a name="line-116"></a><span class="hs-identifier">lstToGST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">C</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span>
</span><a name="line-117"></a><a name="lstToGST"><a href="Data.Astro.Time.Sidereal.html#lstToGST"><span class="hs-identifier">lstToGST</span></a></a><span> </span><a name="local-6989586621679032402"><a href="#local-6989586621679032402"><span class="hs-identifier">longitude</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#LST"><span class="hs-identifier hs-var">LST</span></a><span> </span><a name="local-6989586621679032403"><a href="#local-6989586621679032403"><span class="hs-identifier">lst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DH</span></a><span> </span><a name="local-6989586621679032404"><a href="#local-6989586621679032404"><span class="hs-identifier">dhours</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toDecimalHours"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toDecimalHours</span></a><span> </span><a href="#local-6989586621679032402"><span class="hs-identifier hs-var">longitude</span></a><span>
</span><a name="line-119"></a><span>      </span><a name="local-6989586621679032405"><a href="#local-6989586621679032405"><span class="hs-identifier">gst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">24</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032403"><span class="hs-identifier hs-var">lst</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679032404"><span class="hs-identifier hs-var">dhours</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a href="#local-6989586621679032405"><span class="hs-identifier hs-var">gst</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-comment">-- | Convert Local Sidereal Time to Greenwich Sidereal Time with Day Correction.</span><span>
</span><a name="line-124"></a><span class="hs-comment">-- It takes LST and longitude in decimal degrees</span><span>
</span><a name="line-125"></a><span class="hs-identifier">lstToGSTwDC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">C</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GreenwichSiderealTime"><span class="hs-identifier hs-type">GreenwichSiderealTime</span></a><span>
</span><a name="line-126"></a><a name="lstToGSTwDC"><a href="Data.Astro.Time.Sidereal.html#lstToGSTwDC"><span class="hs-identifier">lstToGSTwDC</span></a></a><span> </span><a name="local-6989586621679032406"><a href="#local-6989586621679032406"><span class="hs-identifier">longitude</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#LST"><span class="hs-identifier hs-var">LST</span></a><span> </span><a name="local-6989586621679032407"><a href="#local-6989586621679032407"><span class="hs-identifier">lst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DH</span></a><span> </span><a name="local-6989586621679032408"><a href="#local-6989586621679032408"><span class="hs-identifier">dhours</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toDecimalHours"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toDecimalHours</span></a><span> </span><a href="#local-6989586621679032406"><span class="hs-identifier hs-var">longitude</span></a><span>
</span><a name="line-128"></a><span>      </span><a name="local-6989586621679032409"><a href="#local-6989586621679032409"><span class="hs-identifier">gst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032407"><span class="hs-identifier hs-var">lst</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679032408"><span class="hs-identifier hs-var">dhours</span></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Time.Sidereal.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a href="#local-6989586621679032409"><span class="hs-identifier hs-var">gst</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- Sidereal time internal functions</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- sidereal 24h correspond to 23:56:04 of solar time</span><span>
</span><a name="line-135"></a><span class="hs-identifier">siderealDayLength</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span>
</span><a name="line-136"></a><a name="siderealDayLength"><a href="Data.Astro.Time.Sidereal.html#siderealDayLength"><span class="hs-identifier">siderealDayLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032410"><span class="hs-identifier hs-var">hours</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">24</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="Data.Astro.Types.html#DH"><span class="hs-identifier hs-var">C</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DH</span></a><span> </span><a name="local-6989586621679032410"><a href="#local-6989586621679032410"><span class="hs-identifier">hours</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#fromHMS"><span class="hs-identifier hs-var">fromHMS</span></a><span> </span><span class="hs-number">23</span><span> </span><span class="hs-number">56</span><span> </span><span class="hs-number">04.0916</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">solarSiderealTimesDiff</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#TimeBaseType"><span class="hs-identifier hs-type">TimeBaseType</span></a><span>
</span><a name="line-141"></a><a name="solarSiderealTimesDiff"><a href="Data.Astro.Time.Sidereal.html#solarSiderealTimesDiff"><span class="hs-identifier">solarSiderealTimesDiff</span></a></a><span> </span><a name="local-6989586621679032411"><a href="#local-6989586621679032411"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032412"><a href="#local-6989586621679032412"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.JulianDate.html#numberOfCenturies"><span class="hs-identifier hs-var">numberOfCenturies</span></a><span> </span><a href="Data.Astro.Time.Epoch.html#j2000"><span class="hs-identifier hs-var">j2000</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><a href="#local-6989586621679032411"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">24</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">6.697374558</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">2400.051336</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679032412"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">0.000025862</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679032412"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679032412"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-144"></a></pre></body></html>