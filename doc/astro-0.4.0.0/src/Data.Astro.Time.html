<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module: Data.Astro.Time
Description: Time
Copyright: Alexander Ignatyev, 2016

Root Time module
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span>
</span><a name="line-11"></a><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>  </span><a href="Data.Astro.Time.html#utToLST"><span class="hs-identifier hs-var">utToLST</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.html#lctToLST"><span class="hs-identifier hs-var">lctToLST</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.html#lstToLCT"><span class="hs-identifier hs-var">lstToLCT</span></a><span>
</span><a name="line-15"></a><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Types.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Time.JulianDate.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JulianDate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilTime"><span class="hs-identifier hs-type">LocalCivilTime</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilDate"><span class="hs-identifier hs-type">LocalCivilDate</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#splitToDayAndTime"><span class="hs-identifier hs-var">splitToDayAndTime</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#addHours"><span class="hs-identifier hs-var">addHours</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Time.Sidereal.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">Sidereal</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#utToGST"><span class="hs-identifier hs-var">utToGST</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToUT"><span class="hs-identifier hs-var">gstToUT</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToLST"><span class="hs-identifier hs-var">gstToLST</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToGST"><span class="hs-identifier hs-var">lstToGST</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToGSTwDC"><span class="hs-identifier hs-var">lstToGSTwDC</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- | Universal Time to Local Sidereal Time.</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- It takes longitude in decimal degrees and local civil time</span><span>
</span><a name="line-26"></a><span class="hs-identifier">utToLST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span>
</span><a name="line-27"></a><a name="utToLST"><a href="Data.Astro.Time.html#utToLST"><span class="hs-identifier">utToLST</span></a></a><span> </span><a name="local-1627417923"><a href="#local-1627417923"><span class="hs-identifier">longitude</span></a></a><span> </span><a name="local-1627417924"><a href="#local-1627417924"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToLST"><span class="hs-identifier hs-var">gstToLST</span></a><span> </span><a href="#local-1627417923"><span class="hs-identifier hs-var">longitude</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Time.Sidereal.html#utToGST"><span class="hs-identifier hs-var">utToGST</span></a><span> </span><a href="#local-1627417924"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- | Local Civil Time to Local Sidereal Time.</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- It takes longitude in decimal degrees and local civil time</span><span>
</span><a name="line-32"></a><span class="hs-identifier">lctToLST</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilTime"><span class="hs-identifier hs-type">LocalCivilTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span>
</span><a name="line-33"></a><a name="lctToLST"><a href="Data.Astro.Time.html#lctToLST"><span class="hs-identifier">lctToLST</span></a></a><span> </span><a name="local-1627417925"><a href="#local-1627417925"><span class="hs-identifier">longitude</span></a></a><span> </span><a name="local-1627417926"><a href="#local-1627417926"><span class="hs-identifier">lct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.html#utToLST"><span class="hs-identifier hs-var">utToLST</span></a><span> </span><a href="#local-1627417925"><span class="hs-identifier hs-var">longitude</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">lctUniversalTime</span><span> </span><a href="#local-1627417926"><span class="hs-identifier hs-var">lct</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Local Sidereal Time to Local Civil Time.</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- It takes longitude in decimal degrees, local civil date and local sidereal time</span><span>
</span><a name="line-38"></a><span class="hs-identifier">lstToLCT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilDate"><span class="hs-identifier hs-type">LocalCivilDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilTime"><span class="hs-identifier hs-type">LocalCivilTime</span></a><span>
</span><a name="line-39"></a><a name="lstToLCT"><a href="Data.Astro.Time.html#lstToLCT"><span class="hs-identifier">lstToLCT</span></a></a><span> </span><a name="local-1627417927"><a href="#local-1627417927"><span class="hs-identifier">longitude</span></a></a><span> </span><a name="local-1627417928"><a href="#local-1627417928"><span class="hs-identifier">lcd</span></a></a><span> </span><a name="local-1627417929"><a href="#local-1627417929"><span class="hs-identifier">lst</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627417930"><a href="#local-1627417930"><span class="hs-identifier">gst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToGST"><span class="hs-identifier hs-var">lstToGST</span></a><span> </span><a href="#local-1627417927"><span class="hs-identifier hs-var">longitude</span></a><span> </span><a href="#local-1627417929"><span class="hs-identifier hs-var">lst</span></a><span>
</span><a name="line-41"></a><span>      </span><a name="local-1627417931"><a href="#local-1627417931"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToUT"><span class="hs-identifier hs-var">gstToUT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lcdDate</span><span> </span><a href="#local-1627417928"><span class="hs-identifier hs-var">lcd</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627417930"><span class="hs-identifier hs-var">gst</span></a><span>
</span><a name="line-42"></a><span>      </span><a name="local-1627417932"><a href="#local-1627417932"><span class="hs-identifier">lct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LCT"><span class="hs-identifier hs-var">LCT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lcdTimeZone</span><span> </span><a href="#local-1627417928"><span class="hs-identifier hs-var">lcd</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627417931"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Data.Astro.Time.html#sameDay"><span class="hs-identifier hs-var">sameDay</span></a><span> </span><a href="#local-1627417928"><span class="hs-identifier hs-var">lcd</span></a><span> </span><a href="#local-1627417932"><span class="hs-identifier hs-var">lct</span></a><span>
</span><a name="line-44"></a><span>     </span><span class="hs-keyword">then</span><span> </span><a href="#local-1627417932"><span class="hs-identifier hs-var">lct</span></a><span> </span><span class="hs-comment">-- lstToLCTwDC longitude timeZone jd lst</span><span>
</span><a name="line-45"></a><span>     </span><span class="hs-keyword">else</span><span> </span><a href="Data.Astro.Time.html#lstToLCTwDC"><span class="hs-identifier hs-var">lstToLCTwDC</span></a><span> </span><a href="#local-1627417927"><span class="hs-identifier hs-var">longitude</span></a><span> </span><a href="#local-1627417928"><span class="hs-identifier hs-var">lcd</span></a><span> </span><a href="#local-1627417929"><span class="hs-identifier hs-var">lst</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">lstToLCTwDC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilDate"><span class="hs-identifier hs-type">LocalCivilDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.Sidereal.html#LocalSiderealTime"><span class="hs-identifier hs-type">LocalSiderealTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilTime"><span class="hs-identifier hs-type">LocalCivilTime</span></a><span>
</span><a name="line-49"></a><a name="lstToLCTwDC"><a href="Data.Astro.Time.html#lstToLCTwDC"><span class="hs-identifier">lstToLCTwDC</span></a></a><span> </span><a name="local-1627417933"><a href="#local-1627417933"><span class="hs-identifier">longitude</span></a></a><span> </span><a name="local-1627417934"><a href="#local-1627417934"><span class="hs-identifier">lcd</span></a></a><span> </span><a name="local-1627417935"><a href="#local-1627417935"><span class="hs-identifier">lst</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627417936"><a href="#local-1627417936"><span class="hs-identifier">gst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#lstToGSTwDC"><span class="hs-identifier hs-var">lstToGSTwDC</span></a><span> </span><a href="#local-1627417933"><span class="hs-identifier hs-var">longitude</span></a><span> </span><a href="#local-1627417935"><span class="hs-identifier hs-var">lst</span></a><span>
</span><a name="line-51"></a><span>      </span><a name="local-1627417937"><a href="#local-1627417937"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.Sidereal.html#gstToUT"><span class="hs-identifier hs-var">gstToUT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lcdDate</span><span> </span><a href="#local-1627417934"><span class="hs-identifier hs-var">lcd</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627417936"><span class="hs-identifier hs-var">gst</span></a><span>
</span><a name="line-52"></a><span>      </span><a name="local-1627417938"><a href="#local-1627417938"><span class="hs-identifier">lct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LCT"><span class="hs-identifier hs-var">LCT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lcdTimeZone</span><span> </span><a href="#local-1627417934"><span class="hs-identifier hs-var">lcd</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627417937"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="#local-1627417938"><span class="hs-identifier hs-var">lct</span></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- | Returns True if both JulianDates hve the same day</span><span>
</span><a name="line-57"></a><span class="hs-identifier">sameDay</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilDate"><span class="hs-identifier hs-type">LocalCivilDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#LocalCivilTime"><span class="hs-identifier hs-type">LocalCivilTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-58"></a><a name="sameDay"><a href="Data.Astro.Time.html#sameDay"><span class="hs-identifier">sameDay</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#LCD"><span class="hs-identifier hs-var">LCD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><a name="local-1627417939"><a href="#local-1627417939"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#LCT"><span class="hs-identifier hs-var">LCT</span></a><span> </span><a name="local-1627417940"><a href="#local-1627417940"><span class="hs-identifier">tz</span></a></a><span> </span><a name="local-1627417941"><a href="#local-1627417941"><span class="hs-identifier">jd2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JD"><span class="hs-identifier hs-var">JD</span></a><span> </span><a name="local-1627417942"><a href="#local-1627417942"><span class="hs-identifier">d2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Time.JulianDate.html#splitToDayAndTime"><span class="hs-identifier hs-var">splitToDayAndTime</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Time.JulianDate.html#addHours"><span class="hs-identifier hs-var">addHours</span></a><span> </span><a href="#local-1627417940"><span class="hs-identifier hs-var">tz</span></a><span> </span><a href="#local-1627417941"><span class="hs-identifier hs-var">jd2</span></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><span class="hs-special">(</span><a href="#local-1627417939"><span class="hs-identifier hs-var">d1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627417942"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0.000001</span><span>
</span><a name="line-61"></a></pre></body></html>