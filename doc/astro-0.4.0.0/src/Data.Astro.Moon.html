<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module: Data.Astro.Moon
Description: Calculation characteristics of the Moon
Copyright: Alexander Ignatyev, 2016

Calculation characteristics of the Moon.

-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Moon</span><span>
</span><a name="line-11"></a><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>  </span><a href="Data.Astro.Moon.html#moonPosition1"><span class="hs-identifier hs-var">moonPosition1</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonDistance1"><span class="hs-identifier hs-var">moonDistance1</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonAngularSize"><span class="hs-identifier hs-var">moonAngularSize</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonHorizontalParallax"><span class="hs-identifier hs-var">moonHorizontalParallax</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonPhase"><span class="hs-identifier hs-var">moonPhase</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonBrightLimbPositionAngle"><span class="hs-identifier hs-var">moonBrightLimbPositionAngle</span></a><span>
</span><a name="line-18"></a><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Astro.Utils.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">U</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Types.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#fromRadians"><span class="hs-identifier hs-var">fromRadians</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Time.JulianDate.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JulianDate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#numberOfDays"><span class="hs-identifier hs-var">numberOfDays</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Coordinate.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Coordinate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Coordinate.html#EclipticCoordinates"><span class="hs-identifier hs-type">EclipticCoordinates</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Coordinate.html#eclipticToEquatorial"><span class="hs-identifier hs-var">eclipticToEquatorial</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Planet.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Planet</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Planet.PlanetMechanics.html#planetBrightLimbPositionAngle"><span class="hs-identifier hs-var">planetBrightLimbPositionAngle</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Sun.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Sun</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Moon</span><span class="hs-operator">.</span><span class="hs-identifier">MoonDetails</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#j2010MoonDetails"><span class="hs-identifier hs-var">j2010MoonDetails</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | Reduce the value to the range [0, 360)</span><span>
</span><a name="line-32"></a><span class="hs-identifier">reduceDegrees</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-33"></a><a name="reduceDegrees"><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier">reduceDegrees</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">U</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">360</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Calculate Equatorial Coordinates of the Moon with the given MoonDetails and at the given JulianDate.</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- It is recommended to use 'j2010MoonDetails' as a first parameter.</span><span>
</span><a name="line-38"></a><span class="hs-identifier">moonPosition1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span>
</span><a name="line-39"></a><a name="moonPosition1"><a href="Data.Astro.Moon.html#moonPosition1"><span class="hs-identifier">moonPosition1</span></a></a><span> </span><a name="local-1627425684"><a href="#local-1627425684"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-1627425685"><a href="#local-1627425685"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627425686"><a href="#local-1627425686"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span> </span><a href="#local-1627425685"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-41"></a><span>      </span><a name="local-1627425687"><a href="#local-1627425687"><span class="hs-identifier">lambdaS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span> </span><a href="#local-1627425686"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-42"></a><span>      </span><a name="local-1627425688"><a href="#local-1627425688"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span> </span><a href="#local-1627425686"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-43"></a><span>      </span><a name="local-1627425689"><a href="#local-1627425689"><span class="hs-identifier">mmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier hs-var">meanMoonQuantities</span></a><span> </span><a href="#local-1627425684"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-1627425685"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-44"></a><span>      </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a name="local-1627425690"><a href="#local-1627425690"><span class="hs-identifier">lm''</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627425691"><a href="#local-1627425691"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier hs-var">correctedMoonQuantities</span></a><span> </span><a href="#local-1627425687"><span class="hs-identifier hs-var">lambdaS</span></a><span> </span><a href="#local-1627425688"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-1627425689"><span class="hs-identifier hs-var">mmq</span></a><span>
</span><a name="line-45"></a><span>      </span><a name="local-1627425692"><a href="#local-1627425692"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627425690"><span class="hs-identifier hs-var">lm''</span></a><span class="hs-glyph">-</span><a href="#local-1627425691"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-46"></a><span>      </span><a name="local-1627425693"><a href="#local-1627425693"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mdI</span><span> </span><a href="#local-1627425684"><span class="hs-identifier hs-var">md</span></a><span>
</span><a name="line-47"></a><span>      </span><a name="local-1627425694"><a href="#local-1627425694"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425692"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-1627425693"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>      </span><a name="local-1627425695"><a href="#local-1627425695"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-1627425692"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-49"></a><span>      </span><a name="local-1627425696"><a href="#local-1627425696"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#fromRadians"><span class="hs-identifier hs-var">fromRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">atan2</span><span> </span><a href="#local-1627425694"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627425695"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-50"></a><span>      </span><a name="local-1627425697"><a href="#local-1627425697"><span class="hs-identifier">lambdaM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627425696"><span class="hs-identifier hs-var">at</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627425691"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-51"></a><span>      </span><a name="local-1627425698"><a href="#local-1627425698"><span class="hs-identifier">betaM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#fromRadians"><span class="hs-identifier hs-var">fromRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">asin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425692"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425693"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Coordinate.html#eclipticToEquatorial"><span class="hs-identifier hs-var">eclipticToEquatorial</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Coordinate.html#EcC"><span class="hs-identifier hs-var">EcC</span></a><span> </span><a href="#local-1627425698"><span class="hs-identifier hs-var">betaM</span></a><span> </span><a href="#local-1627425697"><span class="hs-identifier hs-var">lambdaM</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627425685"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- | Calculates the Moon's Distance at the given julian date.</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- Returns distance to the Moon</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- moonDistance1 :: JulianDate -&gt; MoonDistanceUnits</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- you can use 'mduToKm' (defined in &quot;Data.Astro.Moon.MoonDetails&quot;) to convert result to kilometers</span><span>
</span><a name="line-59"></a><span class="hs-identifier">moonDistance1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span>
</span><a name="line-60"></a><a name="moonDistance1"><a href="Data.Astro.Moon.html#moonDistance1"><span class="hs-identifier">moonDistance1</span></a></a><span> </span><a name="local-1627425699"><a href="#local-1627425699"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-1627425700"><a href="#local-1627425700"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627425701"><a href="#local-1627425701"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span> </span><a href="#local-1627425700"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-62"></a><span>      </span><a name="local-1627425702"><a href="#local-1627425702"><span class="hs-identifier">lambdaS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span> </span><a href="#local-1627425701"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-63"></a><span>      </span><a name="local-1627425703"><a href="#local-1627425703"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span> </span><a href="#local-1627425701"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-64"></a><span>      </span><a name="local-1627425704"><a href="#local-1627425704"><span class="hs-identifier">mmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier hs-var">meanMoonQuantities</span></a><span> </span><a href="#local-1627425699"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-1627425700"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-65"></a><span>      </span><a name="local-1627425705"><a href="#local-1627425705"><span class="hs-identifier">cmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier hs-var">correctedMoonQuantities</span></a><span> </span><a href="#local-1627425702"><span class="hs-identifier hs-var">lambdaS</span></a><span> </span><a href="#local-1627425703"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-1627425704"><span class="hs-identifier hs-var">mmq</span></a><span>
</span><a name="line-66"></a><span>      </span><a name="local-1627425706"><a href="#local-1627425706"><span class="hs-identifier">mm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mqAnomaly</span><span> </span><a href="#local-1627425705"><span class="hs-identifier hs-var">cmq</span></a><span>
</span><a name="line-67"></a><span>      </span><a name="local-1627425707"><a href="#local-1627425707"><span class="hs-identifier">ec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Moon.html#centreEquation"><span class="hs-identifier hs-var">centreEquation</span></a><span> </span><a href="#local-1627425706"><span class="hs-identifier hs-var">mm'</span></a><span>
</span><a name="line-68"></a><span>      </span><a name="local-1627425708"><a href="#local-1627425708"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mdE</span><span> </span><a href="#local-1627425699"><span class="hs-identifier hs-var">md</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MDU"><span class="hs-identifier hs-var">MDU</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425708"><span class="hs-identifier hs-var">e</span></a><span class="hs-operator hs-var">*</span><a href="#local-1627425708"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">+</span><a href="#local-1627425708"><span class="hs-identifier hs-var">e</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-1627425706"><span class="hs-identifier hs-var">mm'</span></a><span class="hs-operator hs-var">+</span><a href="#local-1627425707"><span class="hs-identifier hs-var">ec</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Calculate the Moon's angular size at the given distance.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">moonAngularSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-74"></a><a name="moonAngularSize"><a href="Data.Astro.Moon.html#moonAngularSize"><span class="hs-identifier">moonAngularSize</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.MoonDetails.html#MDU"><span class="hs-identifier hs-var">MDU</span></a><span> </span><a name="local-1627425709"><a href="#local-1627425709"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdBigTheta</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#j2010MoonDetails"><span class="hs-identifier hs-var">j2010MoonDetails</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><a href="#local-1627425709"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Calculates the Moon's horizontal parallax at the given distance.</span><span>
</span><a name="line-78"></a><span class="hs-identifier">moonHorizontalParallax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-79"></a><a name="moonHorizontalParallax"><a href="Data.Astro.Moon.html#moonHorizontalParallax"><span class="hs-identifier">moonHorizontalParallax</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.MoonDetails.html#MDU"><span class="hs-identifier hs-var">MDU</span></a><span> </span><a name="local-1627425710"><a href="#local-1627425710"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdPi</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#j2010MoonDetails"><span class="hs-identifier hs-var">j2010MoonDetails</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><a href="#local-1627425710"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Calculates the Moon's phase (the area of the visible segment expressed as a fraction of the whole disk)</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- at the given universal time.</span><span>
</span><a name="line-84"></a><span class="hs-identifier">moonPhase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-85"></a><a name="moonPhase"><a href="Data.Astro.Moon.html#moonPhase"><span class="hs-identifier">moonPhase</span></a></a><span> </span><a name="local-1627425711"><a href="#local-1627425711"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-1627425712"><a href="#local-1627425712"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627425713"><a href="#local-1627425713"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span> </span><a href="#local-1627425712"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-87"></a><span>      </span><a name="local-1627425714"><a href="#local-1627425714"><span class="hs-identifier">lambdaS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span> </span><a href="#local-1627425713"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-88"></a><span>      </span><a name="local-1627425715"><a href="#local-1627425715"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span> </span><a href="#local-1627425713"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-89"></a><span>      </span><a name="local-1627425716"><a href="#local-1627425716"><span class="hs-identifier">mmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier hs-var">meanMoonQuantities</span></a><span> </span><a href="#local-1627425711"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-1627425712"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-90"></a><span>      </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a name="local-1627425717"><a href="#local-1627425717"><span class="hs-identifier">ml</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier hs-var">correctedMoonQuantities</span></a><span> </span><a href="#local-1627425714"><span class="hs-identifier hs-var">lambdaS</span></a><span> </span><a href="#local-1627425715"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-1627425716"><span class="hs-identifier hs-var">mmq</span></a><span>
</span><a name="line-91"></a><span>      </span><a name="local-1627425718"><a href="#local-1627425718"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627425717"><span class="hs-identifier hs-var">ml</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425714"><span class="hs-identifier hs-var">lambdaS</span></a><span>
</span><a name="line-92"></a><span>      </span><a name="local-1627425719"><a href="#local-1627425719"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-1627425718"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="#local-1627425719"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- | Calculate the Moon's position-angle of the bright limb.</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- It takes the Moon's coordinates and the Sun's coordinates.</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- Position-angle is the angle of the midpoint of the illuminated limb</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- measured eastwards from the north point of the disk.</span><span>
</span><a name="line-101"></a><span class="hs-identifier">moonBrightLimbPositionAngle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-102"></a><a name="moonBrightLimbPositionAngle"><a href="Data.Astro.Moon.html#moonBrightLimbPositionAngle"><span class="hs-identifier">moonBrightLimbPositionAngle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Planet.PlanetMechanics.html#planetBrightLimbPositionAngle"><span class="hs-identifier hs-var">planetBrightLimbPositionAngle</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- | The Moon's quantities</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- Used to store intermidiate results</span><span>
</span><a name="line-107"></a><span class="hs-keyword">data</span><span> </span><a name="MoonQuantities"><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier">MoonQuantities</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MQ"><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier">MQ</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-108"></a><span>  </span><a name="mqLongitude"><a href="Data.Astro.Moon.html#mqLongitude"><span class="hs-identifier">mqLongitude</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>        </span><span class="hs-comment">-- ^ the Moon's longitude</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="mqAnomaly"><a href="Data.Astro.Moon.html#mqAnomaly"><span class="hs-identifier">mqAnomaly</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>        </span><span class="hs-comment">-- ^ the Moon's anomaly</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="mqAscendingNode"><a href="Data.Astro.Moon.html#mqAscendingNode"><span class="hs-identifier">mqAscendingNode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>  </span><span class="hs-comment">-- ^ the Moon's ascending node's longitude</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Calculates the Moon's mean quantities on the given date.</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- It takes the Moon's orbita details and julian date</span><span>
</span><a name="line-116"></a><span class="hs-identifier">meanMoonQuantities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier hs-type">MoonQuantities</span></a><span>
</span><a name="line-117"></a><a name="meanMoonQuantities"><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier">meanMoonQuantities</span></a></a><span> </span><a name="local-1627425720"><a href="#local-1627425720"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-1627425721"><a href="#local-1627425721"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627425722"><a href="#local-1627425722"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Time.JulianDate.html#numberOfDays"><span class="hs-identifier hs-var">numberOfDays</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdEpoch</span><span> </span><a href="#local-1627425720"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627425721"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-119"></a><span>      </span><a name="local-1627425723"><a href="#local-1627425723"><span class="hs-identifier">lm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdL</span><span> </span><a href="#local-1627425720"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">13.1763966</span><span class="hs-operator hs-var">*</span><a href="#local-1627425722"><span class="hs-identifier hs-var">d</span></a><span>  </span><span class="hs-comment">-- Moon's mean longitude</span><span>
</span><a name="line-120"></a><span>      </span><a name="local-1627425724"><a href="#local-1627425724"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627425723"><span class="hs-identifier hs-var">lm</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0.1114041</span><span class="hs-operator hs-var">*</span><a href="#local-1627425722"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdP</span><span> </span><a href="#local-1627425720"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Moon's mean anomaly</span><span>
</span><a name="line-121"></a><span>      </span><a name="local-1627425725"><a href="#local-1627425725"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdN</span><span> </span><a href="#local-1627425720"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0.0529539</span><span class="hs-operator hs-var">*</span><a href="#local-1627425722"><span class="hs-identifier hs-var">d</span></a><span>  </span><span class="hs-comment">-- ascending node's mean longitude</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a href="#local-1627425723"><span class="hs-identifier hs-var">lm</span></a><span> </span><a href="#local-1627425724"><span class="hs-identifier hs-var">mm</span></a><span> </span><a href="#local-1627425725"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- | Calculates correction for the equation of the centre</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- It takes the Moon's corrected anomaly in radians</span><span>
</span><a name="line-127"></a><span class="hs-identifier">centreEquation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-128"></a><a name="centreEquation"><a href="Data.Astro.Moon.html#centreEquation"><span class="hs-identifier">centreEquation</span></a></a><span> </span><a name="local-1627425726"><a href="#local-1627425726"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">6.2886</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425726"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Calculates the Moon's corrected longitude, anomaly and asceding node's longitude</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- It takes the Sun's longitude, the Sun's mean anomaly and the Moon's mean quantities</span><span>
</span><a name="line-133"></a><span class="hs-identifier">correctedMoonQuantities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier hs-type">MoonQuantities</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier hs-type">MoonQuantities</span></a><span>
</span><a name="line-134"></a><a name="correctedMoonQuantities"><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier">correctedMoonQuantities</span></a></a><span> </span><a name="local-1627425727"><a href="#local-1627425727"><span class="hs-identifier">lambdaS</span></a></a><span> </span><a name="local-1627425728"><a href="#local-1627425728"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a name="local-1627425729"><a href="#local-1627425729"><span class="hs-identifier">lm</span></a></a><span> </span><a name="local-1627425730"><a href="#local-1627425730"><span class="hs-identifier">mm</span></a></a><span> </span><a name="local-1627425731"><a href="#local-1627425731"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627425732"><a href="#local-1627425732"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><a href="#local-1627425728"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-136"></a><span>      </span><a name="local-1627425733"><a href="#local-1627425733"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627425729"><span class="hs-identifier hs-var">lm</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425727"><span class="hs-identifier hs-var">lambdaS</span></a><span>
</span><a name="line-137"></a><span>      </span><a name="local-1627425734"><a href="#local-1627425734"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">1.2739</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-1627425733"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425730"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- correction for evection</span><span>
</span><a name="line-138"></a><span>      </span><a name="local-1627425735"><a href="#local-1627425735"><span class="hs-identifier">ae</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.1858</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425732"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- correction for annual equation</span><span>
</span><a name="line-139"></a><span>      </span><a name="local-1627425736"><a href="#local-1627425736"><span class="hs-identifier">a3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.37</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425732"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- third correction</span><span>
</span><a name="line-140"></a><span>      </span><a name="local-1627425737"><a href="#local-1627425737"><span class="hs-identifier">mm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627425730"><span class="hs-identifier hs-var">mm</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-1627425734"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425735"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425736"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Moon's corrected anomaly</span><span>
</span><a name="line-141"></a><span>      </span><a name="local-1627425738"><a href="#local-1627425738"><span class="hs-identifier">mm''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><a href="#local-1627425737"><span class="hs-identifier hs-var">mm'</span></a><span>
</span><a name="line-142"></a><span>      </span><a name="local-1627425739"><a href="#local-1627425739"><span class="hs-identifier">ec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#centreEquation"><span class="hs-identifier hs-var">centreEquation</span></a><span> </span><a href="#local-1627425738"><span class="hs-identifier hs-var">mm''</span></a><span>  </span><span class="hs-comment">-- correction for the equation of the centre</span><span>
</span><a name="line-143"></a><span>      </span><a name="local-1627425740"><a href="#local-1627425740"><span class="hs-identifier">a4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.214</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-1627425738"><span class="hs-identifier hs-var">mm''</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- fourth correction term</span><span>
</span><a name="line-144"></a><span>      </span><a name="local-1627425741"><a href="#local-1627425741"><span class="hs-identifier">lm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627425729"><span class="hs-identifier hs-var">lm</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-1627425734"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627425739"><span class="hs-identifier hs-var">ec</span></a><span> </span><span class="hs-glyph">-</span><a href="#local-1627425735"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627425740"><span class="hs-identifier hs-var">a4</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Moon's corrected longitude</span><span>
</span><a name="line-145"></a><span>      </span><a name="local-1627425742"><a href="#local-1627425742"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.6583</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-1627425741"><span class="hs-identifier hs-var">lm'</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1627425727"><span class="hs-identifier hs-var">lambdaS</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-comment">-- correction for variation</span><span>
</span><a name="line-146"></a><span>      </span><a name="local-1627425743"><a href="#local-1627425743"><span class="hs-identifier">lm''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627425741"><span class="hs-identifier hs-var">lm'</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-1627425742"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-comment">-- Moon's true orbital longitude</span><span>
</span><a name="line-147"></a><span>      </span><a name="local-1627425744"><a href="#local-1627425744"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627425731"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.16</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-1627425732"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ascending node's corrected longitude</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a href="#local-1627425743"><span class="hs-identifier hs-var">lm''</span></a><span> </span><a href="#local-1627425737"><span class="hs-identifier hs-var">mm'</span></a><span> </span><a href="#local-1627425744"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-149"></a></pre></body></html>