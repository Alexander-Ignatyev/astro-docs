<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module: Data.Astro.Moon
Description: Calculation characteristics of the Moon
Copyright: Alexander Ignatyev, 2016

Calculation characteristics of the Moon.

= Example

@
import Data.Astro.Time.JulianDate
import Data.Astro.Coordinate
import Data.Astro.Types
import Data.Astro.Effects
import Data.Astro.CelestialObject.RiseSet
import Data.Astro.Moon

ro :: GeographicCoordinates
ro = GeoC (fromDMS 51 28 40) (-(fromDMS 0 0 5))

dt :: LocalCivilTime
dt = lctFromYMDHMS (DH 1) 2017 6 25 10 29 0

today :: LocalCivilDate
today = lcdFromYMD (DH 1) 2017 6 25

jd :: JulianDate
jd = lctUniversalTime dt

-- distance from the Earth to the Moon in kilometres
mdu :: MoonDistanceUnits
mdu = moonDistance1 j2010MoonDetails jd
-- MDU 0.9550170577020396

distance :: Double
distance = mduToKm mdu
-- 367109.51199772174

-- Angular Size
angularSize :: DecimalDegrees
angularSize = moonAngularSize mdu
-- DD 0.5425033990980761

-- The Moon's coordinates
position :: JulianDate -&gt; EquatorialCoordinates1
position = moonPosition1 j2010MoonDetails

ec1 :: EquatorialCoordinates1
ec1 = position jd
-- EC1 {e1Declination = DD 18.706180658927323, e1RightAscension = DH 7.56710547682055}

hc :: HorizonCoordinates
hc = ec1ToHC ro jd ec1
-- HC {hAltitude = DD 34.57694951316064, hAzimuth = DD 103.91119101451832}

-- Rise and Set
riseSet :: RiseSetMB
riseSet = riseAndSet2 0.000001 position ro verticalShift today
-- RiseSet
--    (Just (2017-06-25 06:22:51.4858 +1.0,DD 57.81458864497365))
--    (Just (2017-06-25 22:28:20.3023 +1.0,DD 300.4168238905249))

-- Phase
phase :: Double
phase = moonPhase j2010MoonDetails jd
-- 2.4716141948212922e-2


sunEC1 :: EquatorialCoordinates1
sunEC1 = sunPosition2 jd
-- EC1 {e1Declination = DD 23.37339098989099, e1RightAscension = DH 6.29262026252748}

limbAngle :: DecimalDegrees
limbAngle = moonBrightLimbPositionAngle ec1 sunEC1
-- DD 287.9869373767473
@
-}</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Moon</span><span>
</span><a name="line-80"></a><span class="hs-special">(</span><span>
</span><a name="line-81"></a><span>  </span><a href="Data.Astro.Moon.html#moonPosition1"><span class="hs-identifier hs-var">moonPosition1</span></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonPosition2"><span class="hs-identifier hs-var">moonPosition2</span></a><span>
</span><a name="line-83"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonDistance1"><span class="hs-identifier hs-var">moonDistance1</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonAngularSize"><span class="hs-identifier hs-var">moonAngularSize</span></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonHorizontalParallax"><span class="hs-identifier hs-var">moonHorizontalParallax</span></a><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonPhase"><span class="hs-identifier hs-var">moonPhase</span></a><span>
</span><a name="line-87"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.html#moonBrightLimbPositionAngle"><span class="hs-identifier hs-var">moonBrightLimbPositionAngle</span></a><span>
</span><a name="line-88"></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Astro.Utils.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">U</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Types.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#GeographicCoordinates"><span class="hs-identifier hs-type">GeographicCoordinates</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#fromRadians"><span class="hs-identifier hs-var">fromRadians</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Types.html#kmToAU"><span class="hs-identifier hs-var">kmToAU</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Time.JulianDate.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JulianDate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Time.JulianDate.html#numberOfDays"><span class="hs-identifier hs-var">numberOfDays</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Coordinate.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Coordinate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Coordinate.html#EclipticCoordinates"><span class="hs-identifier hs-type">EclipticCoordinates</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Coordinate.html#eclipticToEquatorial"><span class="hs-identifier hs-var">eclipticToEquatorial</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Planet.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Planet</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Planet.PlanetMechanics.html#planetBrightLimbPositionAngle"><span class="hs-identifier hs-var">planetBrightLimbPositionAngle</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Sun.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Sun</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Moon</span><span class="hs-operator">.</span><span class="hs-identifier">MoonDetails</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#j2010MoonDetails"><span class="hs-identifier hs-var">j2010MoonDetails</span></a><span class="hs-special">,</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#mduToKm"><span class="hs-identifier hs-var">mduToKm</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Astro.Effects.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Astro</span><span class="hs-operator">.</span><span class="hs-identifier">Effects</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Effects.Parallax.html#parallax"><span class="hs-identifier hs-var">parallax</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | Reduce the value to the range [0, 360)</span><span>
</span><a name="line-103"></a><span class="hs-identifier">reduceDegrees</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-104"></a><a name="reduceDegrees"><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier">reduceDegrees</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Utils.html#reduceToZeroRange"><span class="hs-identifier hs-var">U</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">reduceToZeroRange</span></a><span> </span><span class="hs-number">360</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Calculate Equatorial Coordinates of the Moon with the given MoonDetails and at the given JulianDate.</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- It is recommended to use 'j2010MoonDetails' as a first parameter.</span><span>
</span><a name="line-109"></a><span class="hs-identifier">moonPosition1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span>
</span><a name="line-110"></a><a name="moonPosition1"><a href="Data.Astro.Moon.html#moonPosition1"><span class="hs-identifier">moonPosition1</span></a></a><span> </span><a name="local-6989586621679044289"><a href="#local-6989586621679044289"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679044290"><a href="#local-6989586621679044290"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044291"><a href="#local-6989586621679044291"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span> </span><a href="#local-6989586621679044290"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-112"></a><span>      </span><a name="local-6989586621679044292"><a href="#local-6989586621679044292"><span class="hs-identifier">lambdaS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span> </span><a href="#local-6989586621679044291"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-113"></a><span>      </span><a name="local-6989586621679044293"><a href="#local-6989586621679044293"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span> </span><a href="#local-6989586621679044291"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-114"></a><span>      </span><a name="local-6989586621679044294"><a href="#local-6989586621679044294"><span class="hs-identifier">mmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier hs-var">meanMoonQuantities</span></a><span> </span><a href="#local-6989586621679044289"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-6989586621679044290"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-115"></a><span>      </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a name="local-6989586621679044295"><a href="#local-6989586621679044295"><span class="hs-identifier">lm''</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679044296"><a href="#local-6989586621679044296"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier hs-var">correctedMoonQuantities</span></a><span> </span><a href="#local-6989586621679044292"><span class="hs-identifier hs-var">lambdaS</span></a><span> </span><a href="#local-6989586621679044293"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-6989586621679044294"><span class="hs-identifier hs-var">mmq</span></a><span>
</span><a name="line-116"></a><span>      </span><a name="local-6989586621679044297"><a href="#local-6989586621679044297"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679044295"><span class="hs-identifier hs-var">lm''</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679044296"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-117"></a><span>      </span><a name="local-6989586621679044298"><a href="#local-6989586621679044298"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mdI</span><span> </span><a href="#local-6989586621679044289"><span class="hs-identifier hs-var">md</span></a><span>
</span><a name="line-118"></a><span>      </span><a name="local-6989586621679044299"><a href="#local-6989586621679044299"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044297"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679044298"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>      </span><a name="local-6989586621679044300"><a href="#local-6989586621679044300"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679044297"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-120"></a><span>      </span><a name="local-6989586621679044301"><a href="#local-6989586621679044301"><span class="hs-identifier">at</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#fromRadians"><span class="hs-identifier hs-var">fromRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">atan2</span><span> </span><a href="#local-6989586621679044299"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679044300"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-121"></a><span>      </span><a name="local-6989586621679044302"><a href="#local-6989586621679044302"><span class="hs-identifier">lambdaM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044301"><span class="hs-identifier hs-var">at</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679044296"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-122"></a><span>      </span><a name="local-6989586621679044303"><a href="#local-6989586621679044303"><span class="hs-identifier">betaM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#fromRadians"><span class="hs-identifier hs-var">fromRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">asin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044297"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044298"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Coordinate.html#eclipticToEquatorial"><span class="hs-identifier hs-var">eclipticToEquatorial</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Coordinate.html#EcC"><span class="hs-identifier hs-var">EcC</span></a><span> </span><a href="#local-6989586621679044303"><span class="hs-identifier hs-var">betaM</span></a><span> </span><a href="#local-6989586621679044302"><span class="hs-identifier hs-var">lambdaM</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044290"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Calculate Equatorial Coordinates of the Moon with the given MoonDetails,</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- distance to the Moon, geographic coordinates of the onserver,</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- height above sea-level of the observer measured in metres (20 is a good reasonable value for the height)</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- and at the given JulianDate.</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- It is recommended to use 'j2010MoonDetails' as a first parameter,</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- to obtain the distance to the Moon you can use `moonDistance1` function.</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- `moonPosition2` takes into account parallax effect.</span><span>
</span><a name="line-133"></a><span class="hs-identifier">moonPosition2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#GeographicCoordinates"><span class="hs-identifier hs-type">GeographicCoordinates</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span>
</span><a name="line-134"></a><a name="moonPosition2"><a href="Data.Astro.Moon.html#moonPosition2"><span class="hs-identifier">moonPosition2</span></a></a><span> </span><a name="local-6989586621679044304"><a href="#local-6989586621679044304"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679044305"><a href="#local-6989586621679044305"><span class="hs-identifier">distance</span></a></a><span> </span><a name="local-6989586621679044306"><a href="#local-6989586621679044306"><span class="hs-identifier">coords</span></a></a><span> </span><a name="local-6989586621679044307"><a href="#local-6989586621679044307"><span class="hs-identifier">height</span></a></a><span> </span><a name="local-6989586621679044308"><a href="#local-6989586621679044308"><span class="hs-identifier">jd</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044309"><a href="#local-6989586621679044309"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#moonPosition1"><span class="hs-identifier hs-var">moonPosition1</span></a><span> </span><a href="#local-6989586621679044304"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-6989586621679044308"><span class="hs-identifier hs-var">jd</span></a><span>
</span><a name="line-136"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Effects.Parallax.html#parallax"><span class="hs-identifier hs-var">parallax</span></a><span> </span><a href="#local-6989586621679044306"><span class="hs-identifier hs-var">coords</span></a><span> </span><a href="#local-6989586621679044307"><span class="hs-identifier hs-var">height</span></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#kmToAU"><span class="hs-identifier hs-var">kmToAU</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#mduToKm"><span class="hs-identifier hs-var">mduToKm</span></a><span> </span><a href="#local-6989586621679044305"><span class="hs-identifier hs-var">distance</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044308"><span class="hs-identifier hs-var">jd</span></a><span> </span><a href="#local-6989586621679044309"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Calculates the Moon's Distance at the given julian date.</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- Returns distance to the Moon</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- moonDistance1 :: JulianDate -&gt; MoonDistanceUnits</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- you can use 'mduToKm' (defined in &quot;Data.Astro.Moon.MoonDetails&quot;) to convert result to kilometers</span><span>
</span><a name="line-143"></a><span class="hs-identifier">moonDistance1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span>
</span><a name="line-144"></a><a name="moonDistance1"><a href="Data.Astro.Moon.html#moonDistance1"><span class="hs-identifier">moonDistance1</span></a></a><span> </span><a name="local-6989586621679044310"><a href="#local-6989586621679044310"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679044311"><a href="#local-6989586621679044311"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044312"><a href="#local-6989586621679044312"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span> </span><a href="#local-6989586621679044311"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-146"></a><span>      </span><a name="local-6989586621679044313"><a href="#local-6989586621679044313"><span class="hs-identifier">lambdaS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span> </span><a href="#local-6989586621679044312"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-147"></a><span>      </span><a name="local-6989586621679044314"><a href="#local-6989586621679044314"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span> </span><a href="#local-6989586621679044312"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-148"></a><span>      </span><a name="local-6989586621679044315"><a href="#local-6989586621679044315"><span class="hs-identifier">mmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier hs-var">meanMoonQuantities</span></a><span> </span><a href="#local-6989586621679044310"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-6989586621679044311"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-149"></a><span>      </span><a name="local-6989586621679044316"><a href="#local-6989586621679044316"><span class="hs-identifier">cmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier hs-var">correctedMoonQuantities</span></a><span> </span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">lambdaS</span></a><span> </span><a href="#local-6989586621679044314"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-6989586621679044315"><span class="hs-identifier hs-var">mmq</span></a><span>
</span><a name="line-150"></a><span>      </span><a name="local-6989586621679044317"><a href="#local-6989586621679044317"><span class="hs-identifier">mm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mqAnomaly</span><span> </span><a href="#local-6989586621679044316"><span class="hs-identifier hs-var">cmq</span></a><span>
</span><a name="line-151"></a><span>      </span><a name="local-6989586621679044318"><a href="#local-6989586621679044318"><span class="hs-identifier">ec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Moon.html#centreEquation"><span class="hs-identifier hs-var">centreEquation</span></a><span> </span><a href="#local-6989586621679044317"><span class="hs-identifier hs-var">mm'</span></a><span>
</span><a name="line-152"></a><span>      </span><a name="local-6989586621679044319"><a href="#local-6989586621679044319"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mdE</span><span> </span><a href="#local-6989586621679044310"><span class="hs-identifier hs-var">md</span></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MDU"><span class="hs-identifier hs-var">MDU</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044319"><span class="hs-identifier hs-var">e</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679044319"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679044319"><span class="hs-identifier hs-var">e</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679044317"><span class="hs-identifier hs-var">mm'</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679044318"><span class="hs-identifier hs-var">ec</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | Calculate the Moon's angular size at the given distance.</span><span>
</span><a name="line-157"></a><span class="hs-identifier">moonAngularSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-158"></a><a name="moonAngularSize"><a href="Data.Astro.Moon.html#moonAngularSize"><span class="hs-identifier">moonAngularSize</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.MoonDetails.html#MDU"><span class="hs-identifier hs-var">MDU</span></a><span> </span><a name="local-6989586621679044320"><a href="#local-6989586621679044320"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdBigTheta</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#j2010MoonDetails"><span class="hs-identifier hs-var">j2010MoonDetails</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><a href="#local-6989586621679044320"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">-- | Calculates the Moon's horizontal parallax at the given distance.</span><span>
</span><a name="line-162"></a><span class="hs-identifier">moonHorizontalParallax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDistanceUnits"><span class="hs-identifier hs-type">MoonDistanceUnits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-163"></a><a name="moonHorizontalParallax"><a href="Data.Astro.Moon.html#moonHorizontalParallax"><span class="hs-identifier">moonHorizontalParallax</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.MoonDetails.html#MDU"><span class="hs-identifier hs-var">MDU</span></a><span> </span><a name="local-6989586621679044321"><a href="#local-6989586621679044321"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdPi</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#j2010MoonDetails"><span class="hs-identifier hs-var">j2010MoonDetails</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><a href="#local-6989586621679044321"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">-- | Calculates the Moon's phase (the area of the visible segment expressed as a fraction of the whole disk)</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- at the given universal time.</span><span>
</span><a name="line-168"></a><span class="hs-identifier">moonPhase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-169"></a><a name="moonPhase"><a href="Data.Astro.Moon.html#moonPhase"><span class="hs-identifier">moonPhase</span></a></a><span> </span><a name="local-6989586621679044322"><a href="#local-6989586621679044322"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679044323"><a href="#local-6989586621679044323"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044324"><a href="#local-6989586621679044324"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunDetails"><span class="hs-identifier hs-var">sunDetails</span></a><span> </span><a href="#local-6989586621679044323"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-171"></a><span>      </span><a name="local-6989586621679044325"><a href="#local-6989586621679044325"><span class="hs-identifier">lambdaS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunEclipticLongitude2"><span class="hs-identifier hs-var">sunEclipticLongitude2</span></a><span> </span><a href="#local-6989586621679044324"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-172"></a><span>      </span><a name="local-6989586621679044326"><a href="#local-6989586621679044326"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Sun.html#sunMeanAnomaly2"><span class="hs-identifier hs-var">sunMeanAnomaly2</span></a><span> </span><a href="#local-6989586621679044324"><span class="hs-identifier hs-var">sd</span></a><span>
</span><a name="line-173"></a><span>      </span><a name="local-6989586621679044327"><a href="#local-6989586621679044327"><span class="hs-identifier">mmq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier hs-var">meanMoonQuantities</span></a><span> </span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">md</span></a><span> </span><a href="#local-6989586621679044323"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-174"></a><span>      </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a name="local-6989586621679044328"><a href="#local-6989586621679044328"><span class="hs-identifier">ml</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier hs-var">correctedMoonQuantities</span></a><span> </span><a href="#local-6989586621679044325"><span class="hs-identifier hs-var">lambdaS</span></a><span> </span><a href="#local-6989586621679044326"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-6989586621679044327"><span class="hs-identifier hs-var">mmq</span></a><span>
</span><a name="line-175"></a><span>      </span><a name="local-6989586621679044329"><a href="#local-6989586621679044329"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">ml</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044325"><span class="hs-identifier hs-var">lambdaS</span></a><span>
</span><a name="line-176"></a><span>      </span><a name="local-6989586621679044330"><a href="#local-6989586621679044330"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679044329"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679044330"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- | Calculate the Moon's position-angle of the bright limb.</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- It takes the Moon's coordinates and the Sun's coordinates.</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- Position-angle is the angle of the midpoint of the illuminated limb</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- measured eastwards from the north point of the disk.</span><span>
</span><a name="line-185"></a><span class="hs-identifier">moonBrightLimbPositionAngle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Coordinate.html#EquatorialCoordinates1"><span class="hs-identifier hs-type">EquatorialCoordinates1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-186"></a><a name="moonBrightLimbPositionAngle"><a href="Data.Astro.Moon.html#moonBrightLimbPositionAngle"><span class="hs-identifier">moonBrightLimbPositionAngle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Planet.PlanetMechanics.html#planetBrightLimbPositionAngle"><span class="hs-identifier hs-var">planetBrightLimbPositionAngle</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | The Moon's quantities</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- Used to store intermidiate results</span><span>
</span><a name="line-191"></a><span class="hs-keyword">data</span><span> </span><a name="MoonQuantities"><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier">MoonQuantities</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MQ"><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier">MQ</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-192"></a><span>  </span><a name="mqLongitude"><a href="Data.Astro.Moon.html#mqLongitude"><span class="hs-identifier">mqLongitude</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>        </span><span class="hs-comment">-- ^ the Moon's longitude</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="mqAnomaly"><a href="Data.Astro.Moon.html#mqAnomaly"><span class="hs-identifier">mqAnomaly</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>        </span><span class="hs-comment">-- ^ the Moon's anomaly</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="mqAscendingNode"><a href="Data.Astro.Moon.html#mqAscendingNode"><span class="hs-identifier">mqAscendingNode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>  </span><span class="hs-comment">-- ^ the Moon's ascending node's longitude</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-comment">-- | Calculates the Moon's mean quantities on the given date.</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- It takes the Moon's orbita details and julian date</span><span>
</span><a name="line-200"></a><span class="hs-identifier">meanMoonQuantities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Moon.MoonDetails.html#MoonDetails"><span class="hs-identifier hs-type">MoonDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Time.JulianDate.html#JulianDate"><span class="hs-identifier hs-type">JulianDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier hs-type">MoonQuantities</span></a><span>
</span><a name="line-201"></a><a name="meanMoonQuantities"><a href="Data.Astro.Moon.html#meanMoonQuantities"><span class="hs-identifier">meanMoonQuantities</span></a></a><span> </span><a name="local-6989586621679044331"><a href="#local-6989586621679044331"><span class="hs-identifier">md</span></a></a><span> </span><a name="local-6989586621679044332"><a href="#local-6989586621679044332"><span class="hs-identifier">ut</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044333"><a href="#local-6989586621679044333"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Time.JulianDate.html#numberOfDays"><span class="hs-identifier hs-var">numberOfDays</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdEpoch</span><span> </span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044332"><span class="hs-identifier hs-var">ut</span></a><span>
</span><a name="line-203"></a><span>      </span><a name="local-6989586621679044334"><a href="#local-6989586621679044334"><span class="hs-identifier">lm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdL</span><span> </span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">13.1763966</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679044333"><span class="hs-identifier hs-var">d</span></a><span>  </span><span class="hs-comment">-- Moon's mean longitude</span><span>
</span><a name="line-204"></a><span>      </span><a name="local-6989586621679044335"><a href="#local-6989586621679044335"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679044334"><span class="hs-identifier hs-var">lm</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0.1114041</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679044333"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdP</span><span> </span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Moon's mean anomaly</span><span>
</span><a name="line-205"></a><span>      </span><a name="local-6989586621679044336"><a href="#local-6989586621679044336"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#reduceDegrees"><span class="hs-identifier hs-var">reduceDegrees</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mdN</span><span> </span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">md</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0.0529539</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679044333"><span class="hs-identifier hs-var">d</span></a><span>  </span><span class="hs-comment">-- ascending node's mean longitude</span><span>
</span><a name="line-206"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a href="#local-6989586621679044334"><span class="hs-identifier hs-var">lm</span></a><span> </span><a href="#local-6989586621679044335"><span class="hs-identifier hs-var">mm</span></a><span> </span><a href="#local-6989586621679044336"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | Calculates correction for the equation of the centre</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- It takes the Moon's corrected anomaly in radians</span><span>
</span><a name="line-211"></a><span class="hs-identifier">centreEquation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span>
</span><a name="line-212"></a><a name="centreEquation"><a href="Data.Astro.Moon.html#centreEquation"><span class="hs-identifier">centreEquation</span></a></a><span> </span><a name="local-6989586621679044337"><a href="#local-6989586621679044337"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">6.2886</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044337"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- | Calculates the Moon's corrected longitude, anomaly and asceding node's longitude</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- It takes the Sun's longitude, the Sun's mean anomaly and the Moon's mean quantities</span><span>
</span><a name="line-217"></a><span class="hs-identifier">correctedMoonQuantities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Types.html#DecimalDegrees"><span class="hs-identifier hs-type">DecimalDegrees</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier hs-type">MoonQuantities</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Astro.Moon.html#MoonQuantities"><span class="hs-identifier hs-type">MoonQuantities</span></a><span>
</span><a name="line-218"></a><a name="correctedMoonQuantities"><a href="Data.Astro.Moon.html#correctedMoonQuantities"><span class="hs-identifier">correctedMoonQuantities</span></a></a><span> </span><a name="local-6989586621679044338"><a href="#local-6989586621679044338"><span class="hs-identifier">lambdaS</span></a></a><span> </span><a name="local-6989586621679044339"><a href="#local-6989586621679044339"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a name="local-6989586621679044340"><a href="#local-6989586621679044340"><span class="hs-identifier">lm</span></a></a><span> </span><a name="local-6989586621679044341"><a href="#local-6989586621679044341"><span class="hs-identifier">mm</span></a></a><span> </span><a name="local-6989586621679044342"><a href="#local-6989586621679044342"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044343"><a href="#local-6989586621679044343"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><a href="#local-6989586621679044339"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-220"></a><span>      </span><a name="local-6989586621679044344"><a href="#local-6989586621679044344"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044340"><span class="hs-identifier hs-var">lm</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">lambdaS</span></a><span>
</span><a name="line-221"></a><span>      </span><a name="local-6989586621679044345"><a href="#local-6989586621679044345"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">1.2739</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679044344"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044341"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- correction for evection</span><span>
</span><a name="line-222"></a><span>      </span><a name="local-6989586621679044346"><a href="#local-6989586621679044346"><span class="hs-identifier">ae</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.1858</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- correction for annual equation</span><span>
</span><a name="line-223"></a><span>      </span><a name="local-6989586621679044347"><a href="#local-6989586621679044347"><span class="hs-identifier">a3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.37</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- third correction</span><span>
</span><a name="line-224"></a><span>      </span><a name="local-6989586621679044348"><a href="#local-6989586621679044348"><span class="hs-identifier">mm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044341"><span class="hs-identifier hs-var">mm</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679044345"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044346"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044347"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Moon's corrected anomaly</span><span>
</span><a name="line-225"></a><span>      </span><a name="local-6989586621679044349"><a href="#local-6989586621679044349"><span class="hs-identifier">mm''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><a href="#local-6989586621679044348"><span class="hs-identifier hs-var">mm'</span></a><span>
</span><a name="line-226"></a><span>      </span><a name="local-6989586621679044350"><a href="#local-6989586621679044350"><span class="hs-identifier">ec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Moon.html#centreEquation"><span class="hs-identifier hs-var">centreEquation</span></a><span> </span><a href="#local-6989586621679044349"><span class="hs-identifier hs-var">mm''</span></a><span>  </span><span class="hs-comment">-- correction for the equation of the centre</span><span>
</span><a name="line-227"></a><span>      </span><a name="local-6989586621679044351"><a href="#local-6989586621679044351"><span class="hs-identifier">a4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.214</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679044349"><span class="hs-identifier hs-var">mm''</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- fourth correction term</span><span>
</span><a name="line-228"></a><span>      </span><a name="local-6989586621679044352"><a href="#local-6989586621679044352"><span class="hs-identifier">lm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044340"><span class="hs-identifier hs-var">lm</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679044345"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679044350"><span class="hs-identifier hs-var">ec</span></a><span> </span><span class="hs-glyph">-</span><a href="#local-6989586621679044346"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679044351"><span class="hs-identifier hs-var">a4</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Moon's corrected longitude</span><span>
</span><a name="line-229"></a><span>      </span><a name="local-6989586621679044353"><a href="#local-6989586621679044353"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.6583</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Astro.Types.html#toRadians"><span class="hs-identifier hs-var">toRadians</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679044352"><span class="hs-identifier hs-var">lm'</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">lambdaS</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-comment">-- correction for variation</span><span>
</span><a name="line-230"></a><span>      </span><a name="local-6989586621679044354"><a href="#local-6989586621679044354"><span class="hs-identifier">lm''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044352"><span class="hs-identifier hs-var">lm'</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679044353"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-comment">-- Moon's true orbital longitude</span><span>
</span><a name="line-231"></a><span>      </span><a name="local-6989586621679044355"><a href="#local-6989586621679044355"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044342"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="Data.Astro.Types.html#DD"><span class="hs-identifier hs-var">DD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">0.16</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ascending node's corrected longitude</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Astro.Moon.html#MQ"><span class="hs-identifier hs-var">MQ</span></a><span> </span><a href="#local-6989586621679044354"><span class="hs-identifier hs-var">lm''</span></a><span> </span><a href="#local-6989586621679044348"><span class="hs-identifier hs-var">mm'</span></a><span> </span><a href="#local-6989586621679044355"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-233"></a></pre></body></html>